library(tidyverse)
library(data.table)
library(lme4)
d <- read.csv('../../analysis/exp2/data/dstCleanChoice.csv')
head(d)
head(d)
d$selSafeDeck <- ifelse(d$selectedRiskyDeck == 1, 0, 1)
d$differenceE <- ifelse(d$difference == 'Moderate', -0.5, 0.5)
d$difficultyE <- ifelse(d$difficulty == 'Easier than Reference', -0.5, 0.5)
summary(d$differenceE)
summary(d$difficultyE)
m1 <- glmer(selSafeDeck ~ difficultyE * differenceE + (1 | subject) + (0 + difficultyE | subject) + (0 + differenceE | subject), data = d , family = binomial, control = glmerControl(optimizer = 'bobyqa'))
newdata <- d[, -c('selSafeDeck')]
newdata <- subset(d, select = -c(selSafeDeck))
head(newdata)
simulate(m1, newdata = newdata)
nrow(simulate(m1, newdata = newdata)) == nrow(d)
head(simulate(m1, newdata = newdata))
newdata$proba <- simulate(m1, newdata = newdata)$stim_1
newdata %>%
group_by(subject, difference, difficulty) %>%
summarize(proba = mean(proba)) %>%
group_by(difference, difficulty) %>%
summarize(ssd = mean(proba), se = sd(proba) / sqrt(n())) %>%
ggplot(aes(x = difficulty, y = ssd, group = difference)) _
newdata %>%
group_by(subject, difference, difficulty) %>%
summarize(proba = mean(proba)) %>%
group_by(difference, difficulty) %>%
summarize(ssd = mean(proba), se = sd(proba) / sqrt(n())) %>%
ggplot(aes(x = difficulty, y = ssd, group = difference)) +
geom_bar(stat = 'identity', aes(color = difference), position = position_dodge(width = .9)) +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se), width = .5, position = position_dodge(width = .9))
head(newdata)
newdata$proba <- simulate(m1, newdata = newdata)$sim_1
head(newdata)
newdata %>%
group_by(subject, difference, difficulty) %>%
summarize(proba = mean(proba)) %>%
group_by(difference, difficulty) %>%
summarize(ssd = mean(proba), se = sd(proba) / sqrt(n())) %>%
ggplot(aes(x = difficulty, y = ssd, group = difference)) +
geom_bar(stat = 'identity', aes(color = difference), position = position_dodge(width = .9)) +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se), width = .5, position = position_dodge(width = .9))
q()
